From a8ae6f07362181a9e8a05ddfd1587614d366657b Mon Sep 17 00:00:00 2001
From: Aleksei Sidorov <>
Date: Fri, 17 Jun 2022 15:43:30 +0300
Subject: [PATCH] Fix public config propagation

---
 BUILD.gn | 12 ++++++++----
 1 file changed, 8 insertions(+), 4 deletions(-)

diff --git a/BUILD.gn b/BUILD.gn
index 5422255..dd06081 100644
--- a/BUILD.gn
+++ b/BUILD.gn
@@ -28,6 +28,10 @@ import("//build/config/ohos/rules.gni")
 import("//build/ohos.gni")
 
 config("vixl_public_config") {
+  if (is_debug) {
+    defines = [ "VIXL_DEBUG" ]
+  }
+
   include_dirs = [
     "$ark_third_party_root/vixl",
     "$ark_third_party_root/vixl/src",
@@ -84,7 +88,6 @@ ohos_static_library("libvixl") {
     cflags_cc = []
   }
 
-  cflags_cc += [ "-DVIXL_DEBUG" ]
   if (is_mac) {
     cflags_cc += [
       "-DVIXL_CODE_BUFFER_MALLOC",
@@ -100,9 +103,10 @@ ohos_static_library("libvixl") {
   configs = [
     "$ark_root:ark_config",
     "$ark_root/libpandabase:arkbase_public_config",
-    ":vixl_public_config",
   ]
 
+  public_configs = [ ":vixl_public_config" ]
+
   deps = [ "$ark_root/libpandabase:libarkbase" ]
 
   subsystem_name = "ark"
@@ -150,7 +154,6 @@ ohos_static_library("libvixl_frontend_static") {
     cflags_cc = []
   }
 
-  cflags_cc += [ "-DVIXL_DEBUG" ]
   if (is_mac) {
     cflags_cc += [
       "-DVIXL_CODE_BUFFER_MALLOC",
@@ -166,9 +169,10 @@ ohos_static_library("libvixl_frontend_static") {
   configs = [
     "$ark_root:ark_config",
     "$ark_root/libpandabase:arkbase_public_config",
-    ":vixl_public_config",
   ]
 
+  public_configs = [ ":vixl_public_config" ]
+
   deps = [ "$ark_root/libpandabase:libarkbase_frontend_static" ]
 
   subsystem_name = "ark"
-- 
2.17.1

